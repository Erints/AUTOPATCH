name: AUTOPATCH-Scanner
on: [push]

jobs:
  security-job:
    runs-on: ubuntu-latest
    # This section allows the bot to save the fixed code
    permissions:
      contents: write 
    
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: '3.10'

      - name: Run Scanner and Apply Fixes
        run: python scanner.py

      - name: Save Fixed Code to GitHub
        # These commands tell Git who is saving the file and push it back
        run: |
          git config --global user.name 'AUTOPATCH-Bot'
          git config --global user.email 'bot@autopatch.ai'
          git add .
          git commit -m "üõ°Ô∏è AUTOPATCH: Automated security fixes applied" || echo "No changes to commit"
          git push
